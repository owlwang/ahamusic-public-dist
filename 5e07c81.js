(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{298:function(t,e,n){"use strict";var r=n(10),o=n(17),c=n(305),l=n(31),f=n(163),d=n(8),h=n(121),v=n(65),m=n(25),w=n(316),y=n(317),x=n(162),C=n(120),_=n(93).f,k=n(26).f,R=n(318),U=n(66),A=n(43),M=A.get,I=A.set,E="ArrayBuffer",B="DataView",L="Wrong index",F=r.ArrayBuffer,D=F,S=r.DataView,O=S&&S.prototype,z=Object.prototype,N=r.RangeError,P=y.pack,V=y.unpack,T=function(t){return[255&t]},j=function(t){return[255&t,t>>8&255]},$=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},W=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},J=function(t){return P(t,23,4)},G=function(t){return P(t,52,8)},H=function(t,e){k(t.prototype,e,{get:function(){return M(this)[e]}})},Y=function(view,t,e,n){var r=w(e),o=M(view);if(r+t>o.byteLength)throw N(L);var c=M(o.buffer).bytes,l=r+o.byteOffset,f=c.slice(l,l+t);return n?f:f.reverse()},K=function(view,t,e,n,r,o){var c=w(e),l=M(view);if(c+t>l.byteLength)throw N(L);for(var f=M(l.buffer).bytes,d=c+l.byteOffset,h=n(+r),i=0;i<t;i++)f[d+i]=h[o?i:t-i-1]};if(c){if(!d((function(){F(1)}))||!d((function(){new F(-1)}))||d((function(){return new F,new F(1.5),new F(NaN),F.name!=E}))){for(var Q,X=(D=function(t){return h(this,D),new F(w(t))}).prototype=F.prototype,Z=_(F),tt=0;Z.length>tt;)(Q=Z[tt++])in D||l(D,Q,F[Q]);X.constructor=D}C&&x(O)!==z&&C(O,z);var et=new S(new D(2)),nt=O.setInt8;et.setInt8(0,2147483648),et.setInt8(1,2147483649),!et.getInt8(0)&&et.getInt8(1)||f(O,{setInt8:function(t,e){nt.call(this,t,e<<24>>24)},setUint8:function(t,e){nt.call(this,t,e<<24>>24)}},{unsafe:!0})}else D=function(t){h(this,D,E);var e=w(t);I(this,{bytes:R.call(new Array(e),0),byteLength:e}),o||(this.byteLength=e)},S=function(t,e,n){h(this,S,B),h(t,D,B);var r=M(t).byteLength,c=v(e);if(c<0||c>r)throw N("Wrong offset");if(c+(n=void 0===n?r-c:m(n))>r)throw N("Wrong length");I(this,{buffer:t,byteLength:n,byteOffset:c}),o||(this.buffer=t,this.byteLength=n,this.byteOffset=c)},o&&(H(D,"byteLength"),H(S,"buffer"),H(S,"byteLength"),H(S,"byteOffset")),f(S.prototype,{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var e=Y(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Y(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return W(Y(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return W(Y(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return V(Y(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return V(Y(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){K(this,1,t,T,e)},setUint8:function(t,e){K(this,1,t,T,e)},setInt16:function(t,e){K(this,2,t,j,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){K(this,2,t,j,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){K(this,4,t,$,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){K(this,4,t,$,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){K(this,4,t,J,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){K(this,8,t,G,e,arguments.length>2?arguments[2]:void 0)}});U(D,E),U(S,B),t.exports={ArrayBuffer:D,DataView:S}},305:function(t,e){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},306:function(t,e,n){t.exports={}},315:function(t,e,n){"use strict";var r=n(5),o=n(10),c=n(298),l=n(164),f="ArrayBuffer",d=c.ArrayBuffer;r({global:!0,forced:o.ArrayBuffer!==d},{ArrayBuffer:d}),l(f)},316:function(t,e,n){var r=n(65),o=n(25);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=o(e);if(e!==n)throw RangeError("Wrong length or index");return n}},317:function(t,e){var n=Math.abs,r=Math.pow,o=Math.floor,c=Math.log,l=Math.LN2;t.exports={pack:function(t,e,f){var d,h,v,m=new Array(f),w=8*f-e-1,y=(1<<w)-1,x=y>>1,rt=23===e?r(2,-24)-r(2,-77):0,C=t<0||0===t&&1/t<0?1:0,_=0;for((t=n(t))!=t||t===1/0?(h=t!=t?1:0,d=y):(d=o(c(t)/l),t*(v=r(2,-d))<1&&(d--,v*=2),(t+=d+x>=1?rt/v:rt*r(2,1-x))*v>=2&&(d++,v/=2),d+x>=y?(h=0,d=y):d+x>=1?(h=(t*v-1)*r(2,e),d+=x):(h=t*r(2,x-1)*r(2,e),d=0));e>=8;m[_++]=255&h,h/=256,e-=8);for(d=d<<e|h,w+=e;w>0;m[_++]=255&d,d/=256,w-=8);return m[--_]|=128*C,m},unpack:function(t,e){var n,o=t.length,c=8*o-e-1,l=(1<<c)-1,f=l>>1,d=c-7,h=o-1,v=t[h--],m=127&v;for(v>>=7;d>0;m=256*m+t[h],h--,d-=8);for(n=m&(1<<-d)-1,m>>=-d,d+=e;d>0;n=256*n+t[h],h--,d-=8);if(0===m)m=1-f;else{if(m===l)return n?NaN:v?-1/0:1/0;n+=r(2,e),m-=f}return(v?-1:1)*n*r(2,m-e)}}},318:function(t,e,n){"use strict";var r=n(36),o=n(119),c=n(25);t.exports=function(t){for(var e=r(this),n=c(e.length),l=arguments.length,f=o(l>1?arguments[1]:void 0,n),d=l>2?arguments[2]:void 0,h=void 0===d?n:o(d,n);h>f;)e[f++]=t;return e}},319:function(t,e,n){"use strict";var r=n(5),o=n(8),c=n(298),l=n(13),f=n(119),d=n(25),h=n(122),v=c.ArrayBuffer,m=c.DataView,w=v.prototype.slice;r({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:o((function(){return!new v(2).slice(1,void 0).byteLength}))},{slice:function(t,e){if(void 0!==w&&void 0===e)return w.call(l(this),t);for(var n=l(this).byteLength,r=f(t,n),o=f(void 0===e?n:e,n),c=new(h(this,v))(d(o-r)),y=new m(this),x=new m(c),C=0;r<o;)x.setUint8(C++,y.getUint8(r++));return c}})},320:function(t,e,n){var r=n(5),o=n(298);r({global:!0,forced:!n(305)},{DataView:o.DataView})},321:function(t,e,n){"use strict";n(306)},327:function(t,e,n){"use strict";n.r(e);n(315),n(319),n(18),n(320),n(92),n(52);var r=n(302),o=n.n(r),c={sampleBits:16,sampleRate:8e3,numChannels:1,compiling:!1};function l(data,t,e){for(var i=0;i<e.length;i++)data.setUint8(t+i,e.charCodeAt(i))}var f={noResult:"Couldn’t quite catch that.",permissionDenied:"Ooops, permission error.",incompatible:"Browser incompatibility.",unknown:"Unknown Error"},d={noResult:"Make sure your device can clearly hear the song and try again",permissionDenied:"Please make sure your browser gives us recording permission",incompatible:"Your browser does not support online recording, Please change to a modern browser, we recommend Chrome",unknown:""},h={data:function(){return{isFpActive:!0,recorder:null,timerEnabled:!1,timerCount:10,isResultShow:!1,result:null,errorMsgTitle:f.noResult,errorMsg:d.noResult}},watch:{timerEnabled:function(t){var e=this;t&&setTimeout((function(){e.timerCount--}),1e3)},timerCount:{handler:function(t){var e=this;t>0&&this.timerEnabled?setTimeout((function(){e.timerCount--}),1e3):(this.recorder&&(this.recorder.stop(),this.recognize()),this.reset())},immediate:!0}},methods:{startRecord:function(){var t=this;this.timerEnabled?(console.log("stop"),this.recorder.stop(),this.recognize(),this.reset()):(console.log("start"),o.a.getPermission().then((function(){console.log("permission grant"),t.recorder=new o.a(c),t.timerEnabled=!0,t.recorder.start().then((function(){}),(function(e){t.$sentry.captureException(e),t.errorMsgTitle=e.name,t.errorMsg=e.message}))}),(function(e){console.log(e),"Permission denied"===e.message?(t.errorMsgTitle=f.permissionDenied,t.errorMsg=d.permissionDenied):"浏览器不支持 getUserMedia !"===e.message?(t.errorMsgTitle=f.incompatible,t.errorMsg=d.incompatible):(t.errorMsgTitle=f.unknown,t.errorMsg=e.message),t.isResultShow=!0})))},reset:function(){this.errorMsgTitle=f.noResult,this.errorMsg=d.noResult,this.timerEnabled=!1,this.timerCount=10,this.recorder&&(this.recorder.destroy(),this.recorder=null)},recognize:function(){var t=this,e="";e=this.isFpActive?"https://api.doreso.com/identify":"https://api.doreso.com/humming";var n=function(t,e,n,r,o,c){var f=[32,32,32,32,32,32,32,32],d=n>e?e:n,h=o,v=new ArrayBuffer(44+t.byteLength+f.length),data=new DataView(v),m=r,w=0;l(data,w,"RIFF"),w+=4,data.setUint32(w,36+t.byteLength,c),l(data,w+=4,"WAVE"),l(data,w+=4,"fmt "),w+=4,data.setUint32(w,16,c),w+=4,data.setUint16(w,1,c),w+=2,data.setUint16(w,m,c),w+=2,data.setUint32(w,d,c),w+=4,data.setUint32(w,m*d*(h/8),c),w+=4,data.setUint16(w,m*(h/8),c),w+=2,data.setUint16(w,h,c),l(data,w+=2,"data"),w+=4,data.setUint32(w,t.byteLength,c),w+=4;for(var i=0;i<t.byteLength;)data.setUint8(w,t.getUint8(i)),w++,i++;for(var y=0;y<f.length;)data.setUint8(w,f[y]),w++,y++;return data}(this.recorder.getPCM(),this.recorder.inputSampleRate,this.recorder.outputSampleRate,this.recorder.config.numChannels,this.recorder.oututSampleBits,this.recorder.littleEdian),r=new Blob([n],{type:"audio/wav"}),o=new FormData;o.append("file",r),o.append("sample_size",this.recorder.fileSize),this.$axios.$post(e,o).then((function(e){t.result=e.data,t.isResultShow=!0,console.log(e)})).catch((function(t){console.log(t)}))},uploadFile:function(){this.$refs.upload.click()},openDetailPage:function(){var t="/".concat(this.result.acrid);window.open(t,"_blank")}}},v=(n(321),n(64)),component=Object(v.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bg-gray-50 h-screen"},[n("div",{staticClass:"w-3/4 flex flex-col mx-auto h-screen "},[n("div",{staticClass:"flex flex-row justify-between mt-6",attrs:{id:"header"}},[n("div",{staticClass:"h-28"},[n("Logo"),t._v(" "),n("span",{staticClass:"doreso-text"},[t._v("Song Finder for Browser")])],1),t._v(" "),n("div",{staticClass:"hidden md:flex md:h-28 inline-flex"},[n("a",{attrs:{target:"_blank",href:"https://microsoftedge.microsoft.com/addons/detail/ejfccgmelcclnoadalcepdmnpgcnglfc"}},[n("InstallEdge")],1),t._v(" "),n("a",{attrs:{target:"_blank",href:"https://chrome.google.com/webstore/detail/dpacanjfikmhoddligfbehkpomnbgblf"}},[n("InstallChrome")],1)])]),t._v(" "),n("div",{staticClass:"h-1/2 md:h-4/6 container flex flex-col mt-6 ",attrs:{id:"container"}},[t.isResultShow&&t.result?n("div",{staticClass:" absolute self-center flex mt-28",staticStyle:{"z-index":"10000"}},[n("div",{staticClass:" md:w-80 bg-white p-6 rounded-md tracking-wide shadow-lg"},[n("strong",{staticClass:"text-xl align-center cursor-pointer absolute top-2 right-4",on:{click:function(e){t.isResultShow=!1}}},[t._v("×")]),t._v(" "),n("div",{staticClass:"flex items-center mb-4"},[n("div",{staticClass:"sm"},[n("h4",{staticClass:"text-xl font-semibold"},[t._v("\n                "+t._s(t.result.title)+"\n              ")]),t._v(" "),n("h5",{staticClass:"font-semibold text-blue-600"},[t._v("\n                "+t._s(t.result.artists)+"\n              ")])])]),t._v(" "),n("div",[n("button",{staticClass:"detail-btn mt-4 mb-4",on:{click:function(e){return t.openDetailPage()}}},[n("span",{staticClass:"text-blue-400"},[t._v("View detail")])])])])]):t._e(),t._v(" "),t.isResultShow&&!t.result?n("div",{staticClass:" absolute self-center flex mt-20 md:mt-28",staticStyle:{"z-index":"10000"}},[n("div",{staticClass:"w-60 md:w-80 bg-white p-6 rounded-md tracking-wide shadow-lg"},[n("strong",{staticClass:"text-xl align-center cursor-pointer absolute top-2 right-4",on:{click:function(e){t.isResultShow=!1}}},[t._v("×")]),t._v(" "),n("div",{staticClass:"flex items-center mb-4"},[n("div",{staticClass:"sm"},[n("div",{staticClass:"mb-2"},[n("ICON",{attrs:{type:"error"}})],1),t._v(" "),n("h4",{staticClass:"text-xl font-semibold"},[t._v("\n                "+t._s(t.errorMsgTitle)+"\n                ")]),t._v(" "),n("h5",[t._v("\n                "+t._s(t.errorMsg)+"\n                ")])])])])]):t._e(),t._v(" "),n("div",{staticClass:"flex flex-row justify-center space-x-4 md:space-x-8 pt-8"},[n("div",[n("a",{staticClass:"underline",class:[{"active-record-text":t.isFpActive},"record-text"],attrs:{href:"#"},on:{click:function(e){t.isFpActive=!t.isFpActive}}},[n("ICON",{staticClass:"inline-block",attrs:{type:"record"}}),t._v(" "),n("span",[t._v("RECORD")])],1)]),t._v(" "),n("div",[n("a",{staticClass:"underline ",class:[{"active-record-text":!t.isFpActive},"record-text"],attrs:{href:"#"},on:{click:function(e){t.isFpActive=!t.isFpActive}}},[n("ICON",{staticClass:"inline-block",attrs:{type:"hum"}}),t._v(" "),n("span",[t._v("HUM/SING")])],1)])]),t._v(" "),n("div",{staticClass:"self-center py-6"},[n("button",{class:{"scale-down-center":t.timerEnabled},on:{click:function(e){return t.startRecord()}}},[n("RecordingButton")],1)]),t._v(" "),n("div",{staticClass:"block md:hidden self-center text-white text-xl font-semibold",class:{hidden:t.timerEnabled}},[t._v("\n        Click to recognize\n      ")]),t._v(" "),n("div",{staticClass:"self-center text-white text-2xl font-semibold",class:[t.timerEnabled?"md:block":"hidden",""]},[t._v("\n        Recognizing...\n      ")]),t._v(" "),n("div",{staticClass:"hidden self-center text-white text-2xl font-semibold",class:[t.timerEnabled?"hidden":"md:block",""]},[n("p",[t._v("\n          Play some music and click the\n        ")]),t._v(" "),n("p",[t._v("\n          button to recognize songs now.\n        ")])])]),t._v(" "),t._m(0)])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex flex-row justify-between footer mt-6",attrs:{id:"footer"}},[n("div",{staticClass:"text-gray-500"},[n("div",[t._v("contact@aha-music.com")]),t._v(" "),n("div",{staticClass:"underline"},[n("a",{attrs:{href:"/privacy-policy"}},[t._v("Privacy Policy")])])])])}],!1,null,"3140f8cc",null);e.default=component.exports;installComponents(component,{Logo:n(299).default,InstallEdge:n(308).default,InstallChrome:n(300).default,ICON:n(295).default,RecordingButton:n(301).default})}}]);