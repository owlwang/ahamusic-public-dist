(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{310:function(t,e,n){t.exports={}},322:function(t,e,n){"use strict";n(310)},329:function(t,e,n){"use strict";n.r(e);n(301),n(303),n(17),n(304),n(93),n(51);var r=n(305),o=n.n(r),l={sampleBits:16,sampleRate:8e3,numChannels:1,compiling:!1};function c(data,t,e){for(var i=0;i<e.length;i++)data.setUint8(t+i,e.charCodeAt(i))}var d={noResult:"Couldn’t quite catch that.",permissionDenied:"Ooops, permission error.",incompatible:"Browser incompatibility.",unknown:"Unknown Error"},m={noResult:"Make sure your device can clearly hear the song and try again",permissionDenied:"Please make sure your browser gives us recording permission",incompatible:"Your browser does not support online recording, Please change to a modern browser, we recommend Chrome",unknown:""},v={data:function(){return{isFpActive:!0,recorder:null,timerEnabled:!1,timerCount:10,isResultShow:!1,result:null,errorMsgTitle:d.noResult,errorMsg:m.noResult}},watch:{timerEnabled:function(t){var e=this;t&&setTimeout((function(){e.timerCount--}),1e3)},timerCount:{handler:function(t){var e=this;t>0&&this.timerEnabled?setTimeout((function(){e.timerCount--}),1e3):(this.recorder&&(this.recorder.stop(),this.recognize()),this.reset())},immediate:!0}},methods:{startRecord:function(){var t=this;this.timerEnabled?(console.log("stop"),this.recorder.stop(),this.recognize(),this.reset()):(console.log("start"),o.a.getPermission().then((function(){console.log("permission grant"),t.recorder=new o.a(l),t.timerEnabled=!0,t.recorder.start().then((function(){}),(function(e){t.$sentry.captureException(e),t.errorMsgTitle=e.name,t.errorMsg=e.message}))}),(function(e){console.log(e),"Permission denied"===e.message?(t.errorMsgTitle=d.permissionDenied,t.errorMsg=m.permissionDenied):"浏览器不支持 getUserMedia !"===e.message?(t.errorMsgTitle=d.incompatible,t.errorMsg=m.incompatible):(t.errorMsgTitle=d.unknown,t.errorMsg=e.message),t.isResultShow=!0})))},reset:function(){this.errorMsgTitle=d.noResult,this.errorMsg=m.noResult,this.timerEnabled=!1,this.timerCount=10,this.recorder&&(this.recorder.destroy(),this.recorder=null)},recognize:function(){var t=this,e="";e=this.isFpActive?"https://api.doreso.com/identify":"https://api.doreso.com/humming";var n=function(t,e,n,r,o,l){var d=[32,32,32,32,32,32,32,32],m=n>e?e:n,v=o,h=new ArrayBuffer(44+t.byteLength+d.length),data=new DataView(h),f=r,_=0;c(data,_,"RIFF"),_+=4,data.setUint32(_,36+t.byteLength,l),c(data,_+=4,"WAVE"),c(data,_+=4,"fmt "),_+=4,data.setUint32(_,16,l),_+=4,data.setUint16(_,1,l),_+=2,data.setUint16(_,f,l),_+=2,data.setUint32(_,m,l),_+=4,data.setUint32(_,f*m*(v/8),l),_+=4,data.setUint16(_,f*(v/8),l),_+=2,data.setUint16(_,v,l),c(data,_+=2,"data"),_+=4,data.setUint32(_,t.byteLength,l),_+=4;for(var i=0;i<t.byteLength;)data.setUint8(_,t.getUint8(i)),_++,i++;for(var w=0;w<d.length;)data.setUint8(_,d[w]),_++,w++;return data}(this.recorder.getPCM(),this.recorder.inputSampleRate,this.recorder.outputSampleRate,this.recorder.config.numChannels,this.recorder.oututSampleBits,this.recorder.littleEdian),r=new Blob([n],{type:"audio/wav"}),o=new FormData;o.append("file",r),o.append("sample_size",this.recorder.fileSize),this.$axios.$post(e,o).then((function(e){t.result=e.data,t.isResultShow=!0,console.log(e)})).catch((function(t){console.log(t)}))},uploadFile:function(){this.$refs.upload.click()},openDetailPage:function(){var t="/".concat(this.result.acrid);window.open(t,"_blank")}}},h=(n(322),n(64)),component=Object(h.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bg-gray-50 h-screen"},[n("div",{staticClass:"w-3/4 flex flex-col mx-auto h-screen "},[n("div",{staticClass:"flex flex-row justify-between mt-6",attrs:{id:"header"}},[n("div",{staticClass:"h-28"},[n("Logo"),t._v(" "),n("span",{staticClass:"doreso-text"},[t._v("Song Finder for Browser")])],1),t._v(" "),n("div",{staticClass:"hidden md:flex md:h-28 inline-flex"},[n("a",{attrs:{target:"_blank",href:"https://microsoftedge.microsoft.com/addons/detail/ejfccgmelcclnoadalcepdmnpgcnglfc"}},[n("InstallEdge")],1),t._v(" "),n("a",{attrs:{target:"_blank",href:"https://chrome.google.com/webstore/detail/dpacanjfikmhoddligfbehkpomnbgblf"}},[n("InstallChrome")],1)])]),t._v(" "),n("div",{staticClass:"h-1/2 md:h-4/6 container flex flex-col mt-6 ",attrs:{id:"container"}},[t.isResultShow&&t.result?n("div",{staticClass:" absolute self-center flex mt-28",staticStyle:{"z-index":"10000"}},[n("div",{staticClass:" md:w-80 bg-white p-6 rounded-md tracking-wide shadow-lg"},[n("strong",{staticClass:"text-xl align-center cursor-pointer absolute top-2 right-4",on:{click:function(e){t.isResultShow=!1}}},[t._v("×")]),t._v(" "),n("div",{staticClass:"flex items-center mb-4"},[n("div",{staticClass:"sm"},[n("h4",{staticClass:"text-xl font-semibold"},[t._v("\n                "+t._s(t.result.title)+"\n              ")]),t._v(" "),n("h5",{staticClass:"font-semibold text-blue-600"},[t._v("\n                "+t._s(t.result.artists)+"\n              ")])])]),t._v(" "),n("div",[n("button",{staticClass:"detail-btn mt-4 mb-4",on:{click:function(e){return t.openDetailPage()}}},[n("span",{staticClass:"text-blue-400"},[t._v("View detail")])])])])]):t._e(),t._v(" "),t.isResultShow&&!t.result?n("div",{staticClass:" absolute self-center flex mt-20 md:mt-28",staticStyle:{"z-index":"10000"}},[n("div",{staticClass:"w-60 md:w-80 bg-white p-6 rounded-md tracking-wide shadow-lg"},[n("strong",{staticClass:"text-xl align-center cursor-pointer absolute top-2 right-4",on:{click:function(e){t.isResultShow=!1}}},[t._v("×")]),t._v(" "),n("div",{staticClass:"flex items-center mb-4"},[n("div",{staticClass:"sm"},[n("div",{staticClass:"mb-2"},[n("ICON",{attrs:{type:"error"}})],1),t._v(" "),n("h4",{staticClass:"text-xl font-semibold"},[t._v("\n                "+t._s(t.errorMsgTitle)+"\n                ")]),t._v(" "),n("h5",[t._v("\n                "+t._s(t.errorMsg)+"\n                ")])])])])]):t._e(),t._v(" "),n("div",{staticClass:"flex flex-row justify-center space-x-4 md:space-x-8 pt-8"},[n("div",[n("a",{staticClass:"underline",class:[{"active-record-text":t.isFpActive},"record-text"],attrs:{href:"#"},on:{click:function(e){t.isFpActive=!t.isFpActive}}},[n("ICON",{staticClass:"inline-block",attrs:{type:"record"}}),t._v(" "),n("span",[t._v("RECORD")])],1)]),t._v(" "),n("div",[n("a",{staticClass:"underline ",class:[{"active-record-text":!t.isFpActive},"record-text"],attrs:{href:"#"},on:{click:function(e){t.isFpActive=!t.isFpActive}}},[n("ICON",{staticClass:"inline-block",attrs:{type:"hum"}}),t._v(" "),n("span",[t._v("HUM/SING")])],1)])]),t._v(" "),n("div",{staticClass:"self-center pt-8 md:pt-20 pb-8"},[n("button",{on:{click:function(e){return t.startRecord()}}},[n("div",{staticClass:"circleBase grid place-items-center"},[n("div",{staticClass:"btn-container"},[n("div",{class:{wave1:!t.timerEnabled,wave:t.timerEnabled,loading_load__animation__1:t.timerEnabled}}),t._v(" "),n("div",{class:{wave2:!t.timerEnabled,wave:t.timerEnabled,loading_load__animation__2:t.timerEnabled}}),t._v(" "),n("div",{class:{wave3:!t.timerEnabled,wave:t.timerEnabled,loading_load__animation__3:t.timerEnabled}}),t._v(" "),n("div",{class:{wave4:!t.timerEnabled,wave:t.timerEnabled,loading_load__animation__4:t.timerEnabled}})])])])]),t._v(" "),n("div",{staticClass:"block md:hidden self-center text-white text-xl font-semibold",class:{hidden:t.timerEnabled}},[t._v("\n        Click to recognize\n      ")]),t._v(" "),n("div",{staticClass:"self-center text-white text-2xl font-semibold",class:[t.timerEnabled?"md:block":"hidden",""]},[t._v("\n        Recognizing...\n      ")]),t._v(" "),n("div",{staticClass:"hidden self-center text-white text-2xl font-semibold",class:[t.timerEnabled?"hidden":"md:block",""]},[n("p",[t._v("\n          Play some music and click the\n        ")]),t._v(" "),n("p",[t._v("\n          button to recognize songs now.\n        ")])])]),t._v(" "),t._m(0)])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex flex-row justify-between footer mt-6",attrs:{id:"footer"}},[n("div",{staticClass:"text-gray-500"},[n("div",[t._v("contact@aha-music.com")]),t._v(" "),n("div",{staticClass:"underline"},[n("a",{attrs:{href:"/privacy-policy.html"}},[t._v("Privacy Policy")])])]),t._v(" "),n("div",[n("div",{staticClass:"underline"},[n("a",{staticClass:"twitter-follow-button",attrs:{href:"https://twitter.com/MusicIdentifier?ref_src=twsrc%5Etfw","data-show-count":"false"}},[t._v("Follow @MusicIdentifier")]),t._v(" "),n("script",{attrs:{async:"",src:"https://platform.twitter.com/widgets.js",charset:"utf-8"}})])])])}],!1,null,"4998f8be",null);e.default=component.exports;installComponents(component,{Logo:n(296).default,InstallEdge:n(300).default,InstallChrome:n(297).default,ICON:n(295).default})}}]);